<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Giỏ hàng - NhatEbook.com</title>

    <!-- Link CSS  -->
    <link rel="stylesheet" href="./assets/css/base.css">
    <link rel="stylesheet" href="./assets/css/main.css">

    <!-- Link Bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Link Font  -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Nunito+Sans:ital,opsz,wght@0,6..12,200..1000;1,6..12,200..1000&display=swap"
        rel="stylesheet">

    <!-- Link Icon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>

    <div class="container-fluid wrapper mt-0" style="min-height: 100vh;">
        <div class="container-lg checkOut-layout" style="max-width: 123rem;">
            <div class="return-cart">
                <a href="index.html">
                    <i class="fa-solid fa-arrow-left"></i>
                    Quay lại trang chủ
                </a>
                <h1>
                    Danh sách sản phẩm trong giỏ hàng
                </h1>


                <!-- <div class="cart-local">
                    <div class="cart-local-item">

                    </div>
                </div> -->

                <div class="cart-list">
                    <div class="cart-item">
                        <img src="./assets/images/images_FlashSales/FlashSale_Book2.jpg" alt="">

                        <div class="cart-wrap-content">
                            <div class="cart-info">
                                <div class="cart-name">Đàn Gà Trong Sân</div>
                                <div class="cart-price-wrap">
                                    <div class="cart-price cart-price--new">22.500 đ</div>
                                    <div class="cart-price cart-price--old">22.500 đ</div>
                                </div>
                            </div>

                            <!-- <div class="cart-quantity">1</div> -->
                            <div class="quantity-box__wrap-span">
                                <span class="quantity-box__span quantity-box__span--minus">
                                    <i class="fa-solid fa-minus"></i>
                                </span>
                                <span class="quantity-box__span quantity-box__span--num">1</span>
                                <span class="quantity-box__span quantity-box__span--plus">
                                    <i class="fa-solid fa-plus"></i>
                                </span>
                            </div>

                            <div class="cart-return-price">40.000 đ</div>

                            <button class="cart-remove-btn" onclick="removeCart(this)">
                                <i class="fa-regular fa-trash-can"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="cart-right">
                <h1>Thanh toán</h1>
                <div class="cart-form">
                    <div class="cart-group">
                        <label for="">Họ tên</label>
                        <input type="text" placeholder="Nhập họ tên của bạn" id="fullname">
                    </div>
                    <div class="cart-group">
                        <label for="">Số điện thoại</label>
                        <input type="text" placeholder="Nhập số điện thoại của bạn" id="phoneNumber">
                    </div>
                    <div class="cart-group">
                        <label for="">Địa chỉ</label>
                        <input type="text" placeholder="Nhập địa chỉ của bạn" id="address">
                    </div>
                </div>

                <div class="cart-wrap">
                    <div class="cart-row">
                        <div>Tổng Số Lượng</div>
                        <div class="cart-total-quantity">0</div>
                    </div>
                    <div class="cart-row">
                        <div>Tổng tiền</div>
                        <div class="cart-total-price">0 đ</div>
                    </div>
                </div>

                <button class="btn-check-out">
                    Thanh Toán
                </button>
            </div>
        </div>
    </div>


    <!-- modal checkout  -->
    <div class="modal-checkout-wrap">
        <div class="modal-checkout">
            <div class="modal-checkout__icon">
                <i class="fa-solid fa-check"></i>
            </div>
            <p class="modal-checkout__description">Bạn đã thanh toán thành công</p>
        </div>
    </div>


    <!-- Cart localStorgrae -->
    <!-- <script>
        // localStorage
        let totalQuantityHTML = document.querySelector('.cart-total-quantity');
        let totalPriceHTML = document.querySelector('.cart-total-price');
        let totalQuantity = 0;
        let totalPrice = 0;
        function loadCart() {
            // Tải giỏ hàng từ LocalStorage
            const cartData = JSON.parse(localStorage.getItem('cart')) || [];
            const cartDiv = document.querySelector('.cart-list');

            if (cartData.length === 0) {
                cartDiv.innerHTML = 'Giỏ hàng trống';
            } else {
                cartDiv.innerHTML = ''; // Xóa nội dung hiện có

                cartData.forEach((product, index) => {
                    const productDiv = document.createElement('div');
                    productDiv.classList.add('cart-item');
                    productDiv.innerHTML = `<img src="${product.image}" alt="">

                   <div class="cart-wrap-content">
                         <div class="cart-info">
                        <div class="cart-name">${product.name}</div>
                        <div class="cart-price-wrap">
                            <div class="cart-price cart-price--new">${product.price} đ</div>
                            <div class="cart-price cart-price--old">${product.old_price} đ</div>
                        </div>
                    </div>

                    <div class="quantity-box__wrap-span">
                            <span class="quantity-box__span quantity-box__span--minus">
                                <i class="fa-solid fa-minus"></i>
                            </span>
                            <span class="quantity-box__span quantity-box__span--num">${product.quantity}</span>
                            <span class="quantity-box__span quantity-box__span--plus">
                                <i class="fa-solid fa-plus"></i>
                            </span>
                        </div>
                    <div class="cart-return-price">
                    ${product.price * product.quantity} VNĐ 
                    </div>
                    <button class="cart-remove-btn" onclick="removeCart(this,${index})">
                        <i class="fa-regular fa-trash-can"></i>    
                    </button>
                    </div>`;
                    cartDiv.appendChild(productDiv);
                    totalQuantity = totalQuantity + product.quantity;
                    totalPrice = totalPrice + (product.price * product.quantity);
                });
                totalQuantityHTML.innerText = totalQuantity;
                totalPriceHTML.innerText = totalPrice + ' VNĐ';

            }
            updateCheckoutButton(); // Cập nhật trạng thái nút thanh toán
        }

        const btnCheckOut = document.querySelector('.btn-check-out');
        const modalCheckOut = document.querySelector('.modal-checkout-wrap');
        function btn() {
            const fullname = document.getElementById('fullname').value;
            const phoneNumber = document.getElementById('phoneNumber').value;
            const address = document.getElementById('address').value;

            if (fullname && phoneNumber && address) {
                // Nếu đầy đủ, thực hiện quy trình thanh toán
                localStorage.removeItem('cart');
                document.querySelector('.cart-list').innerHTML = '';

                totalQuantityHTML.innerText = 0;
                totalPriceHTML.innerText = 0;

                modalCheckOut.style.display = 'flex';

                // Xóa giá trị của các ô input
                document.getElementById('fullname').value = '';
                document.getElementById('phoneNumber').value = '';
                document.getElementById('address').value = '';

                updateCheckoutButton(); // Cập nhật trạng thái nút thanh toán

                setTimeout(function () {
                    modalCheckOut.style.display = 'none';
                }, 1000);
            } else {
                // Nếu không đầy đủ, hiển thị thông báo lỗi
                alert('Vui lòng điền đầy đủ thông tin để thanh toán.');
            }
        }

        btnCheckOut.addEventListener('click', btn);

        function removeCart(button, index) {
            // console.log(index);
            // const cartData = JSON.parse(localStorage.getItem('cart')) || [];

            // var listItem = button.parentNode;
            // // Xác định phần tử cha của listItem, tức là ul
            // var productList = listItem.parentNode;
            // // Xóa listItem khỏi danh sách sản phẩm
            // productList.removeChild(listItem);

            const cartData = JSON.parse(localStorage.getItem('cart')) || [];

            // Lấy sản phẩm được xóa để tính tổng số lượng và tổng tiền
            const removedProduct = cartData[index];

            // Xóa sản phẩm khỏi giỏ hàng
            cartData.splice(index, 1);

            // Cập nhật giỏ hàng trong LocalStorage
            localStorage.setItem('cart', JSON.stringify(cartData));

            // Tính lại tổng số lượng và tổng tiền từ giỏ hàng mới sau khi xóa sản phẩm
            let newTotalQuantity = 0;
            let newTotalPrice = 0;

            cartData.forEach(product => {
                newTotalQuantity += product.quantity;
                newTotalPrice += product.price * product.quantity;
            });

            // Hiển thị lại tổng số lượng và tổng tiền
            totalQuantity = newTotalQuantity;
            totalPrice = newTotalPrice;

            document.querySelector('.cart-total-quantity').innerText = totalQuantity;
            totalPriceHTML.innerText = totalPrice + ' VNĐ';

            // Load lại giỏ hàng để hiển thị
            loadCart();


        }

        function updateCheckoutButton() {
            const cartData = JSON.parse(localStorage.getItem('cart')) || [];
            // Vô hiệu hóa nút thanh toán nếu giỏ hàng trống
            btnCheckOut.disabled = (cartData.length === 0);
        }

        loadCart();
    </script> -->

    <!-- Fix cart 1 -->
    <!-- <script>
        // localStorage
        let totalQuantityHTML = document.querySelector('.cart-total-quantity');
        let totalPriceHTML = document.querySelector('.cart-total-price');
        let totalQuantity = 0;
        let totalPrice = 0;

        function loadCart() {
            // Tải giỏ hàng từ LocalStorage
            const cartData = JSON.parse(localStorage.getItem('cart')) || [];
            const cartDiv = document.querySelector('.cart-list');

            if (cartData.length === 0) {
                cartDiv.innerHTML = 'Giỏ hàng trống';
            } else {
                cartDiv.innerHTML = ''; // Xóa nội dung hiện có

                cartData.forEach((product, index) => {
                    const productDiv = document.createElement('div');
                    productDiv.classList.add('cart-item');
                    productDiv.innerHTML = `<img src="${product.image}" alt="">
    
                    <div class="cart-wrap-content">
                        <div class="cart-info">
                            <div class="cart-name">${product.name}</div>
                            <div class="cart-price-wrap">
                                <div class="cart-price cart-price--new">${product.price} đ</div>
                                <div class="cart-price cart-price--old">${product.old_price} đ</div>
                            </div>
                        </div>
    
                        <div class="quantity-box__wrap-span">
                            <span class="quantity-box__span quantity-box__span--minus" data-index="${index}">
                                <i class="fa-solid fa-minus"></i>
                            </span>
                            <span class="quantity-box__span quantity-box__span--num">${product.quantity}</span>
                            <span class="quantity-box__span quantity-box__span--plus" data-index="${index}">
                                <i class="fa-solid fa-plus"></i>
                            </span>
                        </div>
                        <div class="cart-return-price">
                        ${product.price * product.quantity} VNĐ 
                        </div>
                        <button class="cart-remove-btn" onclick="removeCart(${index})">
                            <i class="fa-regular fa-trash-can"></i>    
                        </button>
                    </div>`;
                    cartDiv.appendChild(productDiv);
                    totalQuantity += product.quantity;
                    totalPrice += (product.price * product.quantity);
                });
                totalQuantityHTML.innerText = totalQuantity;
                totalPriceHTML.innerText = totalPrice + ' VNĐ';
            }

            updateCheckoutButton(); // Cập nhật trạng thái nút thanh toán
            addEventListeners(); // Thêm các sự kiện cho các nút
        }

        function addEventListeners() {
            const minusButtons = document.querySelectorAll('.quantity-box__span--minus');
            const plusButtons = document.querySelectorAll('.quantity-box__span--plus');

            minusButtons.forEach(button => {
                button.addEventListener('click', function () {
                    updateQuantity(this, -1);
                });
            });

            plusButtons.forEach(button => {
                button.addEventListener('click', function () {
                    updateQuantity(this, 1);
                });
            });
        }

        function updateQuantity(element, change) {
            const index = parseInt(element.getAttribute('data-index'));
            let cartData = JSON.parse(localStorage.getItem('cart')) || [];

            if (cartData[index].quantity + change > 0) {
                cartData[index].quantity += change;
            }

            localStorage.setItem('cart', JSON.stringify(cartData));
            loadCart();
        }

        function removeCart(index) {
            let cartData = JSON.parse(localStorage.getItem('cart')) || [];
            cartData.splice(index, 1);
            localStorage.setItem('cart', JSON.stringify(cartData));
            loadCart();
        }

        const btnCheckOut = document.querySelector('.btn-check-out');
        const modalCheckOut = document.querySelector('.modal-checkout-wrap');
        function btn() {
            const fullname = document.getElementById('fullname').value;
            const phoneNumber = document.getElementById('phoneNumber').value;
            const address = document.getElementById('address').value;

            if (fullname && phoneNumber && address) {
                localStorage.removeItem('cart');
                document.querySelector('.cart-list').innerHTML = '';

                totalQuantityHTML.innerText = 0;
                totalPriceHTML.innerText = 0;

                modalCheckOut.style.display = 'flex';

                document.getElementById('fullname').value = '';
                document.getElementById('phoneNumber').value = '';
                document.getElementById('address').value = '';

                updateCheckoutButton();

                setTimeout(function () {
                    modalCheckOut.style.display = 'none';
                }, 1000);
            } else {
                alert('Vui lòng điền đầy đủ thông tin để thanh toán.');
            }
        }

        btnCheckOut.addEventListener('click', btn);

        function updateCheckoutButton() {
            const cartData = JSON.parse(localStorage.getItem('cart')) || [];
            btnCheckOut.disabled = (cartData.length === 0);
        }

        loadCart();
    </script> -->


    <!-- Fix cart 2 -->
    <script>
        let totalQuantityHTML = document.querySelector('.cart-total-quantity');
        let totalPriceHTML = document.querySelector('.cart-total-price');

        function loadCart() {
            // Tải giỏ hàng từ LocalStorage
            const cartData = JSON.parse(localStorage.getItem('cart')) || [];
            const cartDiv = document.querySelector('.cart-list');

            let totalQuantity = 0;
            let totalPrice = 0;

            if (cartData.length === 0) {
                cartDiv.innerHTML = 'Giỏ hàng trống';
            } else {
                cartDiv.innerHTML = ''; // Xóa nội dung hiện có

                cartData.forEach((product, index) => {
                    const productDiv = document.createElement('div');
                    productDiv.classList.add('cart-item');
                    productDiv.innerHTML = `<img src="${product.image}" alt="">
                        <div class="cart-wrap-content">
                            <div class="cart-info">
                                <div class="cart-name">${product.name}</div>
                                <div class="cart-price-wrap">
                                    <div class="cart-price cart-price--new">${product.price} đ</div>
                                    <div class="cart-price cart-price--old">${product.old_price} đ</div>
                                </div>
                            </div>
                            <div class="quantity-box__wrap-span">
                                <span class="quantity-box__span quantity-box__span--minus" data-index="${index}">
                                    <i class="fa-solid fa-minus"></i>
                                </span>
                                <span class="quantity-box__span quantity-box__span--num">${product.quantity}</span>
                                <span class="quantity-box__span quantity-box__span--plus" data-index="${index}">
                                    <i class="fa-solid fa-plus"></i>
                                </span>
                            </div>
                            <div class="cart-return-price">
                                ${product.price * product.quantity} VNĐ 
                            </div>
                            <button class="cart-remove-btn" onclick="removeCart(${index})">
                                <i class="fa-regular fa-trash-can"></i>    
                            </button>
                        </div>`;
                    cartDiv.appendChild(productDiv);

                    totalQuantity += product.quantity;
                    totalPrice += (product.price * product.quantity);
                });
            }

            totalQuantityHTML.innerText = totalQuantity;
            totalPriceHTML.innerText = totalPrice + ' VNĐ';

            updateCheckoutButton(); // Cập nhật trạng thái nút thanh toán
            addEventListeners(); // Thêm các sự kiện cho các nút
        }

        function addEventListeners() {
            const minusButtons = document.querySelectorAll('.quantity-box__span--minus');
            const plusButtons = document.querySelectorAll('.quantity-box__span--plus');

            minusButtons.forEach(button => {
                button.addEventListener('click', function () {
                    updateQuantity(this, -1);
                });
            });

            plusButtons.forEach(button => {
                button.addEventListener('click', function () {
                    updateQuantity(this, 1);
                });
            });
        }

        function updateQuantity(element, change) {
            const index = parseInt(element.getAttribute('data-index'));
            let cartData = JSON.parse(localStorage.getItem('cart')) || [];

            if (cartData[index].quantity + change > 0) {
                cartData[index].quantity += change;
            }

            localStorage.setItem('cart', JSON.stringify(cartData));
            loadCart();
        }

        function removeCart(index) {
            let cartData = JSON.parse(localStorage.getItem('cart')) || [];
            cartData.splice(index, 1);
            localStorage.setItem('cart', JSON.stringify(cartData));
            loadCart();
        }

        const btnCheckOut = document.querySelector('.btn-check-out');
        const modalCheckOut = document.querySelector('.modal-checkout-wrap');
        function btn() {
            const fullname = document.getElementById('fullname').value;
            const phoneNumber = document.getElementById('phoneNumber').value;
            const address = document.getElementById('address').value;

            if (fullname && phoneNumber && address) {
                localStorage.removeItem('cart');
                document.querySelector('.cart-list').innerHTML = '';

                totalQuantityHTML.innerText = 0;
                totalPriceHTML.innerText = 0;

                modalCheckOut.style.display = 'flex';

                document.getElementById('fullname').value = '';
                document.getElementById('phoneNumber').value = '';
                document.getElementById('address').value = '';

                updateCheckoutButton();

                setTimeout(function () {
                    modalCheckOut.style.display = 'none';
                }, 1000);
            } else {
                alert('Vui lòng điền đầy đủ thông tin để thanh toán.');
            }
        }

        btnCheckOut.addEventListener('click', btn);

        function updateCheckoutButton() {
            const cartData = JSON.parse(localStorage.getItem('cart')) || [];
            btnCheckOut.disabled = (cartData.length === 0);
        }

        loadCart();
    </script>

    <!-- Tăng giảm số lượng sản phẩm  -->
    <script>
        // Quantity product 
        const plus = document.querySelector('.quantity-box__span--plus');
        const num = document.querySelector('.quantity-box__span--num');
        const minus = document.querySelector('.quantity-box__span--minus');

        let a = 1;

        plus.addEventListener('click', () => {
            a++;
            num.innerText = a;
            updateTotal()
        })

        minus.addEventListener('click', () => {
            if (a > 1) {
                a--;
                num.innerText = a;
            }

            updateTotal()
        })


        function updateTotal() {
            const cartData = JSON.parse(localStorage.getItem('cart')) || [];
            let totalPrice = 0;
            let totalQuantity = 0;
            let price = 0;

            cartData.forEach(function (product) {
                product.quantity = a; // Cập nhật số lượng sản phẩm trong giỏ hàng
                totalPrice += product.price * product.quantity;
                price += product.price * product.quantity;
                totalQuantity += product.quantity;
            });

            // Cập nhật tổng số lượng và tổng tiền
            document.querySelector('.cart-total-quantity').innerText = totalQuantity;
            document.querySelector('.cart-total-price').innerText = totalPrice + ' VNĐ';
            document.querySelector('.cart-return-price').innerText = price + ' VNĐ';

            // Cập nhật giỏ hàng trong LocalStorage
            localStorage.setItem('cart', JSON.stringify(cartData));
        }
    </script>
</body>

</html>